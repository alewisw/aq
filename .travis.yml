language: cpp

compiler:  
    - gcc
     
git:
  depth: 1
  
install:
    - mkdir _Build
    - cd _Build
    - tar xf ../Tools/Linux/lcov_1.11.orig.tar.gz
    - sudo make -C lcov-1.11/ install
    - gem install coveralls-lcov
    - lcov --version
    
before_script: 
    - mkdir _Build
    - cd _Build 
    - mkdir Debug
    - cd Debug
    - cmake ../.. -DCMAKE_BUILD_TYPE=DEBUG
    - cd ..
    - mkdir Release
    - cd Release
    - cmake ../.. -DCMAKE_BUILD_TYPE=RELEASE
    - cd ..
    - mkdir Performance
    - cd Performance
    - cmake ../.. -DCMAKE_BUILD_TYPE=PERFORMANCE
    - cd ..

script: 
    - cd Debug
    - make  
    - cd ..
    - cd Release
    - make  
    - cd ..
    - cd Performance
    - make  
    - cd ..
    - cd Debug
    - lcov --rc lcov_branch_coverage=1 --directory . --zerocounters
    - ./UnitTest/UnitTest
    - lcov --rc lcov_branch_coverage=1 --directory . --capture --output-file coverage.info
    - lcov --rc lcov_branch_coverage=1 --remove coverage.info '/usr/*' 'TestLib/*' 'UnitTest/*' 'TraceBuffer.cpp' 'TraceBuffer.h' 'TraceManager.cpp' 'TraceManager.h' 'TestPointNotifier.cpp' 'TestPointNotifier.h' --output-file aq-coverage.info
    - lcov --rc lcov_branch_coverage=1 --list aq-coverage.info

